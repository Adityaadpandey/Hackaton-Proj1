import { GoogleGenerativeAI } from "@google/generative-ai";

const apiKey = "AIzaSyAg2bGH7Unh701ftOV1VDkM32S0Uc20cdM";
const genAI = new GoogleGenerativeAI(apiKey);

const model = genAI.getGenerativeModel({
  model: "gemini-1.5-flash-8b",
  systemInstruction:
    "Type,Dates,Likes,Shares,Comments\nCarousel,2024-10-01,863,160,86\nCarousel,2024-10-02,967,112,143\nCarousel,2024-10-03,1200,176,167\nReel,2024-10-03,1183,438,88\nStatic,2024-10-03,962,148,65\nReel,2024-10-04,1709,322,128\nReel,2024-10-05,1879,125,235\nStatic,2024-10-06,516,101,121\nCarousel,2024-10-06,887,99,81\nReel,2024-10-06,1380,486,293\nCarousel,2024-10-07,532,137,94\nCarousel,2024-10-07,935,123,59\nCarousel,2024-10-07,600,257,144\nReel,2024-10-08,1665,418,252\nCarousel,2024-10-09,700,200,87\nStatic,2024-10-09,874,194,105\nReel,2024-10-10,1994,361,120\nCarousel,2024-10-11,1118,280,89\nCarousel,2024-10-11,794,211,148\nCarousel,2024-10-12,865,126,89\nCarousel,2024-10-12,1002,277,155\nStatic,2024-10-13,954,136,116\nCarousel,2024-10-13,537,98,62\nCarousel,2024-10-14,1415,110,194\nReel,2024-10-14,1232,173,260\nReel,2024-10-15,1960,178,192\nStatic,2024-10-15,580,150,68\nStatic,2024-10-15,622,66,127\nStatic,2024-10-16,733,184,125\nStatic,2024-10-17,833,137,79\nStatic,2024-10-18,835,134,97\nStatic,2024-10-19,908,117,124\nStatic,2024-10-20,813,97,145\nReel,2024-10-20,1342,265,256\nCarousel,2024-10-21,1051,177,45\nReel,2024-10-21,1069,237,148\nStatic,2024-10-21,669,158,118\nStatic,2024-10-22,570,166,88\nCarousel,2024-10-23,535,99,127\nReel,2024-10-23,1619,292,83\nStatic,2024-10-23,989,191,94\nCarousel,2024-10-24,931,158,31\nCarousel,2024-10-24,875,110,154\nReel,2024-10-25,801,265,148\nReel,2024-10-25,1632,198,99\nStatic,2024-10-25,606,163,47\nCarousel,2024-10-26,701,182,86\nReel,2024-10-26,1857,248,80\nStatic,2024-10-26,437,156,56\nReel,2024-10-27,1345,298,220\nStatic,2024-10-28,715,193,143\nCarousel,2024-10-29,1394,171,41\nReel,2024-10-29,1127,481,299\nStatic,2024-10-30,450,153,45\nCarousel,2024-10-31,823,214,61\nReel,2024-10-31,809,386,227\nReel,2024-11-01,1914,340,265\nCarousel,2024-11-02,1184,189,194\nStatic,2024-11-02,546,86,73\nReel,2024-11-03,826,376,154\nStatic,2024-11-03,787,107,84\nCarousel,2024-11-04,537,169,58\nStatic,2024-11-04,514,73,32\nCarousel,2024-11-04,1352,139,111\nCarousel,2024-11-05,796,210,112\nReel,2024-11-06,1416,478,264\nReel,2024-11-06,966,451,55\nStatic,2024-11-06,607,50,115\nCarousel,2024-11-07,1298,255,45\nCarousel,2024-11-07,1443,187,196\nReel,2024-11-07,1918,129,198\nStatic,2024-11-08,561,106,80\nCarousel,2024-11-08,538,138,37\nStatic,2024-11-09,414,166,111\nCarousel,2024-11-10,614,167,121\nStatic,2024-11-11,336,96,138\nReel,2024-11-12,902,224,137\nCarousel,2024-11-12,1354,232,187\nCarousel,2024-11-13,806,150,106\nStatic,2024-11-13,823,111,75\nCarousel,2024-11-13,1194,270,84\nStatic,2024-11-14,977,183,138\nCarousel,2024-11-14,720,256,147\nStatic,2024-11-15,470,86,55\nStatic,2024-11-15,947,95,62\nStatic,2024-11-16,365,192,60\nReel,2024-11-17,1851,290,269\nCarousel,2024-11-18,526,221,93\nStatic,2024-11-19,829,174,126\nCarousel,2024-11-20,610,247,141\nReel,2024-11-20,1942,469,164\nReel,2024-11-20,925,381,206\nCarousel,2024-11-21,1139,98,168\nCarousel,2024-11-22,1401,206,52\nReel,2024-11-23,1289,494,282\nCarousel,2024-11-23,1047,121,193\nStatic,2024-11-23,599,127,61\nReel,2024-11-24,861,131,218\nCarousel,2024-11-24,1445,176,146\nReel,2024-11-24,800,145,298\nStatic,2024-11-25,984,50,97\nCarousel,2024-11-25,590,183,147\nCarousel,2024-11-25,1439,119,144\nReel,2024-11-26,1627,319,192\nReel,2024-11-26,1829,398,248\nCarousel,2024-11-26,644,280,72\nStatic,2024-11-27,721,157,81\nCarousel,2024-11-27,1282,159,124\nStatic,2024-11-28,818,177,51\nCarousel,2024-11-29,754,278,52\nReel,2024-11-29,884,207,148\nReel,2024-12-01,1034,231,60\nReel,2024-12-02,826,433,103\nCarousel,2024-12-02,646,255,191\nReel,2024-12-03,1541,268,180\nStatic,2024-12-03,545,200,21\nCarousel,2024-12-04,1417,123,167\nCarousel,2024-12-04,1386,125,50\nStatic,2024-12-04,506,146,149\nCarousel,2024-12-05,813,104,117\nReel,2024-12-06,1747,471,61\nStatic,2024-12-06,779,82,56\nStatic,2024-12-07,992,192,119\nCarousel,2024-12-07,1060,299,44\nCarousel,2024-12-07,1222,88,88\nReel,2024-12-08,829,189,184\nCarousel,2024-12-08,1221,104,104\nReel,2024-12-09,920,482,198\nCarousel,2024-12-10,916,131,90\nStatic,2024-12-10,706,94,44\nReel,2024-12-11,1662,275,269\nCarousel,2024-12-12,510,258,141\nStatic,2024-12-12,595,123,121\nCarousel,2024-12-12,583,148,31\nStatic,2024-12-13,857,133,107\nStatic,2024-12-14,674,54,73\nCarousel,2024-12-15,1100,145,102\nReel,2024-12-16,1901,349,216\nCarousel,2024-12-17,524,300,156\nCarousel,2024-12-17,905,150,109\nReel,2024-12-18,1243,327,156\nStatic,2024-12-18,517,162,35\nCarousel,2024-12-18,834,125,128\nReel,2024-12-19,995,421,147\nCarousel,2024-12-19,1336,84,146\nStatic,2024-12-20,917,98,100\nStatic,2024-12-20,981,194,98\nStatic,2024-12-21,619,73,81\nStatic,2024-12-21,978,177,90\nCarousel,2024-12-21,1236,272,196\nReel,2024-12-22,1286,248,242\nStatic,2024-12-22,878,66,109\nStatic,2024-12-23,551,197,82\nCarousel,2024-12-24,726,215,46\nReel,2024-12-24,1569,193,283\nStatic,2024-12-25,945,171,79\nReel,2024-12-25,1377,367,168\nCarousel,2024-12-25,1213,208,37\nReel,2024-12-26,1200,422,220\nReel,2024-12-27,1756,499,70\nCarousel,2024-12-27,589,145,102\nReel,2024-12-28,1593,236,84\nCarousel,2024-12-29,725,213,157\nStatic,2024-12-30,998,56,142\nReel,2024-12-30,1953,332,117\nCarousel,2024-12-30,1209,126,183\nReel,2024-12-31,1812,317,240\nReel,2024-12-31,1116,124,141\nYou are an expert data analyst specialized in social media analytics. Using the provided social media data, analyze the engagement metrics and provide actionable insights.\\n\\nRequired Analysis:\\n1. Profile Overview\\n- Analyze follower-following ratio\\n- Calculate posting frequency\\n- Assess account growth indicators\\n\\n2. Content Analysis\\n- Evaluate hashtag usage and effectiveness\\n- Identify posting patterns\\n- Analyze content type distribution\\n\\n3. Key Insights (minimum 1)\\n- Each insight should include:\\n  * Finding\\n  * Supporting data\\n  * Confidence level (High/Medium/Low)\\n\\n4. Recommendations\\n- Provide 3-5 actionable recommendations\\n- Include expected impact\\n- Prioritize based on data confidence\\n\\n\\n\\nQuestion: {question}\\nAnswer:",
});

const generationConfig = {
  temperature: 1,
  topP: 0.95,
  topK: 40,
  maxOutputTokens: 8192,
  responseMimeType: "text/plain",
};

export async function GetResponse(Prompt: string) {
  const chatSession = model.startChat({
    generationConfig,
    history: [],
  });

  const result = await chatSession.sendMessage(Prompt);
  return result.response.text();
}
